# TODO:
# - monitor Shelly binary_sensor.*_firmware_update sensors
# - HA OS update: binary_sensor.home_assistant_operating_system_update_available, sensor.home_assistant_operating_system_newest_version
# - Supervisor addon updates: binary_sensor.*_update_available, sensor.*_newest_version
# TODO: rewrite similar to 'battery_low', having 1 boolean that indicates if any low, then just render list

# Hide the whole block when no updates
type: conditional
conditions:
  - entity: binary_sensor.updates_available
    state: "on"
card:
  type: vertical-stack
  cards:
    - type: custom:button-card
      name: ⬇️ Updates
      template: header
    - type: horizontal-stack
      cards:
        # HA updates: button to the update page
        - type: conditional
          conditions:
            - entity: update.home_assistant_core_update
              state: "on"
          card:
            type: custom:button-card
            entity: update.home_assistant_core_update
            name: Home Assistant
            show_icon: false
            show_label: true
            label: "[[[ return states['update.home_assistant_core_update'].attributes.latest_version; ]]]"
            hold_action:
                action: url
                url_path: "[[[ return states['update.home_assistant_core_update'].attributes.release_url; ]]]"
            styles:
              card:
                - height: '60px'
              label:
                - opacity: 0.7
                  font-size: '80%'

        # Show the HACS updates number when there are any
        - type: conditional
          conditions:
            - entity: binary_sensor.updates_available_hacs
              state: "on"
          card:
            type: custom:button-card
            entity: sensor.hacs
            name: HACS
            show_icon: false
            show_label: true
            label: "[[[ return states['sensor.hacs'].state + ' update' + (states['sensor.hacs'].state>1 ? 's' : ''); ]]]"
            tap_action:
              action: navigate
              navigation_path: /hacs/entry
            styles:
              card:
                - height: '60px'
              label:
                - opacity: 0.7
                  font-size: '80%'
