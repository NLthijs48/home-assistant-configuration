# Summary column for an overview of the inside environment
# TODO: split this up into a few buttons:
# - Current usage
# - Last day
# - Long term
type: vertical-stack
cards:
  - type: custom:button-card
    name: âš¡ Electricity
    template: header_standalone
    # Show details popup when clicking the header
    tap_action:
      action: fire-dom-event
      browser_mod:
        command: popup
        title: Electricity
        card:
          type: vertical-stack
          cards:
            # Most recent data
            - type: vertical-stack
              title: Last hour
              cards:
                - !include last_hour.yaml
            # Last day
            - type: vertical-stack
              title: Daily
              cards:
                - type: energy-date-selection
                - type: energy-distribution
                - type: energy-usage-graph
                - type: energy-sources-table
                - type: energy-devices-graph
                # Current power usage of devices
                - type: custom:auto-entities
                  card:
                    type: entities
                    title: Power usage
                  filter:
                    include:
                      - attributes:
                          device_class: power
                        options:
                          secondary_info: last-changed
                        state: "> 0"
                    exclude:
                      - state: unavailable
                      - attributes:
                          unit_of_measurement: kW
                  sort:
                    method: state
                    numeric: true
                    reverse: true
            # Last 3 days
            - type: vertical-stack
              title: Last 3 days
              cards:
                - !include last_three_days.yaml
            # Future: list of devices (after Shelly plugs have been installed)
            #- type: energy-devices-graph
            # Total usage
            - type: vertical-stack
              title: Totals
              cards:
                - type: entity
                  entity: sensor.energy_consumption_tarif_2
                - type: entity
                  entity: sensor.energy_consumption_tarif_1
  - !include last_hour.yaml
