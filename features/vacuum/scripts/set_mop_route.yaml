alias: Set Roborock mopping route
mode: single
fields:
  route:
    description: 'Mopping route - can be: standard | deep'
    example: 'standard'
sequence:
  - alias: Config variables
    variables:
      config_mopping_route:
        'standard': 300
        deep: 301
      mopping_route: '{{ config_mopping_route[route]}}'
  - choose:
      - alias: Invalid mopping route value
        conditions:
          - condition: template
            value_template: '{{ route not in config_mopping_route|list }}'
        sequence:
          - service: system_log.write
            data:
              message: >-
                Invalid mopping_route value '{{ route }}'. Valid values are {{
                config_mopping_route|list|join(', ') }}
              level: warning
              logger: roborock
    default:
      - alias: Set mopping route
        service: vacuum.send_command
        target:
          entity_id: vacuum.duster
        data:
          command: set_mop_mode
          params: '[{{ mopping_route }}]'
