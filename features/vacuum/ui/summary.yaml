type: vertical-stack
cards:
  # Header with popup
  - type: custom:button-card
    name: ðŸ§¹ Vacuum
    template: header
    tap_action:
      action: fire-dom-event
      browser_mod:
        service: browser_mod.popup
        data:
          title: ðŸ§¹ Vacuum
          content:
            type: vertical-stack
            cards:
              - type: entity
                entity: vacuum.duster
              - !include maps.yaml
              # Broken, not sure if works with Roborock integration: - !include map.yaml
              - !include details.yaml
              # To start anyway when already running
              - !include start_buttons.yaml

  # Entity state (when not docked or idle)
  - type: conditional
    conditions:
      # On the dock/charger
      - entity: vacuum.duster
        state_not: docked
      # Idle (happens when placing it on another floor)
      - entity: vacuum.duster
        state_not: idle
    card:
      type: entity
      entity: vacuum.duster

  # Start buttons (when not cleaning)
  - type: conditional
    conditions:
      - entity: vacuum.duster
        state_not: cleaning
      - entity: vacuum.duster
        state_not: returning
      - entity: vacuum.duster
        state_not: paused
      - entity: vacuum.duster
        state_not: error
    card: !include start_buttons.yaml

  # Map (during cleaning)
  - type: conditional
    conditions:
      - entity: vacuum.duster
        state_not: docked
    card:
      type: picture-glance
      camera_view: auto
      entities: []
      camera_image: camera.roborock_s7_map
